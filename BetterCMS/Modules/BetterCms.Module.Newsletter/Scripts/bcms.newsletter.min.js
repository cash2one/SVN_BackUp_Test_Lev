bettercms.define("bcms.newsletter",["bcms.jquery","bcms","bcms.siteSettings","bcms.dynamicContent","bcms.ko.extenders","bcms.ko.grid","bcms.antiXss"],function(a,c,l,d,g,h,b){var j={},k={},i={loadSiteSettingsSubscribersUrl:null,loadSubscribersUrl:null,saveSubscriberUrl:null,deleteSubscriberUrl:null},e={deleteSubscriberDialogTitle:null};j.links=i;j.globalization=e;j.selectors=k;var m=(function(o){c.extendsClass(p,o);function p(q,s,r){o.call(this,q,i.loadSubscribersUrl,s,r);}p.prototype.createItem=function(q){var r=new n(this,q);return r;};return p;})(h.ListViewModel);var n=(function(o){c.extendsClass(p,o);function p(r,q){o.call(this,r,q);var s=this;s.email=g.observable().extend({required:"",email:"",maxLength:{maxLength:g.maxLength.email}});s.registerFields(s.email);s.email(q.Email);}p.prototype.getDeleteConfirmationMessage=function(){return a.format(e.deleteSubscriberDialogTitle,b.encodeHtml(this.email()));};p.prototype.getSaveParams=function(){var q=o.prototype.getSaveParams.call(this);q.Email=this.email();return q;};return p;})(h.ItemViewModel);function f(r){var o=l.getMainContainer(),p=(r.Success==true)?r.Data:{};var s=new m(o,p.Items,p.GridOptions);s.deleteUrl=i.deleteSubscriberUrl;s.saveUrl=i.saveSubscriberUrl;g.applyBindings(s,o.get(0));var q=o.find("input[type=text],textarea,select").filter(":visible:first");if(q){q.focus();}}j.loadSiteSettingsNewsletterSubscribers=function(){d.bindSiteSettings(l,i.loadSiteSettingsSubscribersUrl,{contentAvailable:f});};j.init=function(){c.logger.debug("Initializing bcms.newsletter module.");};c.registerInit(j.init);return j;});